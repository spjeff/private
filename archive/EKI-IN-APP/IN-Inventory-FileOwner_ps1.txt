<#
.SYNOPSIS
    Download list of UNC network share special file types and owner (created by, modified by).
    
.NOTES
	File Namespace	: IN-Inventory-FileOwners.ps1
	Author			: Jeff Jones
	Version			: 0.1
    Last Modified	: 02-21-2019
#>


# Module
Import-Module ActiveDirectory -ErrorAction SilentlyContinue | Out-Null


# Computer
Function DownloadFileOwners() {
    # Default
    Write-Host "Downloading FileOwners..."
    $sourcePath = "D:\TMP"
    $coll = @()

    # Loop
    $items = Get-ChildItem -Path $sourcePath -Include @("*.accdb", "*.mdb", "*.mde", "*.log") -Recurse
    foreach ($i in $items) {
        $owner = ($i | Get-Acl).Owner
        $obj = $i
        $obj | Add-Member -TypeName NoteProperty -NotePropertyName "Owner" -NotePropertyValue $owner
        $coll += $obj
    }

    # Save
    $coll | Export-Csv "IN-FileOwners.csv" -NoTypeInformation -Force
}


# Main
Function Main() {
    Start-Transcript
    DownloadFileOwners
    Stop-Transcript
}
Main